<?xml version="1.0"?>
<project name="svn-oliv" basedir="." default="help">
  
  <property file="build.properties"/>
  
  <target name="all" depends="geomutils, core, parser, charts, polar.smoother, almanac, nmea.reader, weather.wizard"/>
  
  <target name="clean.all">
    <ant antfile="build.geomutils.xml" target="clean" dir="."/>  
    <ant antfile="build.core.xml" target="clean" dir="."/>  
    <ant antfile="build.parser.xml" target="clean" dir="."/>  
    <ant antfile="build.charts.xml" target="clean" dir="."/>  
    <ant antfile="build.nmea.reader.xml" target="clean" dir="."/>  
    <ant antfile="build.almanac.xml" target="clean" dir="."/>  
    <ant antfile="build.almanac.tools.xml" target="clean" dir="."/>  
    <ant antfile="build.polar.smoother.xml" target="clean" dir="."/>  
    <ant antfile="build.ww.xml" target="clean" dir="."/>  
    <delete dir="classes"/>  
    <delete dir="all-libs"/>  
  </target>
  
  <target name="geomutils">
    <echo message="Making GeomUtils"/>
    <ant antfile="build.geomutils.xml" target="all" dir="."/>  
  </target>
  
  <target name="core">
    <echo message="Making CoreUtilities"/>
    <ant antfile="build.core.xml" target="all" dir="."/>  
  </target>
  
  <target name="parser">
    <echo message="Making NMEAParser"/>
    <ant antfile="build.parser.xml" target="all" dir="."/>  
  </target>

  <target name="polar.smoother">
    <echo message="Making Polar Smoother"/>
    <ant antfile="build.polar.smoother.xml" target="all" dir="."/>  
  </target>

  <target name="almanac">
    <echo message="Making Nautical Almanac"/>
    <ant antfile="build.almanac.xml" target="all" dir="."/>  
  </target>

  <target name="nmea.reader">
    <echo message="Making NMEA Reader"/>
    <ant antfile="build.nmea.reader.xml" target="all" dir="."/>  
  </target>

  <target name="charts">
    <echo message="Making ChartComponents"/>
    <ant antfile="build.charts.xml" target="all" dir="."/>  
  </target>

  <target name="weather.wizard">
    <echo message="Making Weather Wizard"/>
    <ant antfile="build.ww.xml" target="all" dir="."/>  
  </target>

  <target name="run.config">
    <echo message="Copying configuration files"/>
  <mkdir dir="faxDir"/>
  <mkdir dir="gribDir"/>
  <mkdir dir="compositeDir"/>
  <mkdir dir="patterns"/>
    <patternset id="places.xml">
      <include name="**/places.xml"/>
    </patternset>
    <patternset id="dyn.fax.xml">
      <include name="**/dyn.fax.xml"/>
    </patternset>

    <!--copy todir=".">
      <fileset dir="src.chart.lib/sql" >
        <patternset refid="places.xml"/>
      </fileset>
    </copy-->
    <copy todir=".">
      <fileset dir="src.ww" >
        <patternset refid="dyn.fax.xml"/>
        <patternset refid="places.xml"/>
      </fileset>
    </copy>

  </target>

  <target name="run.ww" depends="run.config">
  <path id="3rd.classpath">
    <fileset dir="all-3rd-party">
      <include name="**/*.jar"/>
    </fileset>
  </path>  
  <path id="classpath">
    <fileset dir="all-libs">
      <include name="**/*.jar"/>
    </fileset>
  </path>  
    <path id="desktop.classpath">
      <path refid="3rd.classpath"/>
      <path refid="classpath"/>
    </path>
    <java classname="main.splash.Splasher" dir="." fork="yes">
      <classpath refid="desktop.classpath"/>
    <jvmarg line="-client -Djava.library.path=all-3rd-party/rxtx.distrib/${system.type}"/>
    </java>
  </target>

  <target name="run.ps" depends="run.config">
  <path id="3rd.classpath">
    <fileset dir="all-3rd-party">
      <include name="**/*.jar"/>
    </fileset>
  </path>  
  <path id="classpath">
    <fileset dir="all-libs">
      <include name="**/*.jar"/>
    </fileset>
  </path>  
    <path id="desktop.classpath">
      <path refid="3rd.classpath"/>
      <path refid="classpath"/>
    </path>
    <java classname="polarmaker.polars.main.PolarSmoother" dir="." fork="yes">
      <classpath refid="desktop.classpath"/>
    <jvmarg line="-client"/>
    </java>
  </target>

  <target name="help">
    <echo>
      Will check out the required project from http://code.google.com,
      compile and archive them.
      
      The required projects are:
      - coreutilities
      - javanmeaparser
      - chartcomponents
    - and more!
      
      The target named "all" takes care of everything.
      
      Some 3rd party jar files are required:
      - xmlparserv2.jar from Oracle.
    - JavaAdvancedImaging from Sun.
      - RXTXcomm.jar, for the Java Communication API (Serial ports access).
      All are available for free.
    </echo>
  </target>

</project>
